# 🚀 Mileage Thief 커뮤니티 완성 로드맵

## 📊 현재 상태 (Current Status) - 2025.07.02 업데이트

### ✅ 완료된 기능 (Day 1 완성: ~80%)
- [x] 게시글 목록 표시 (CommunityScreen)
- [x] 무한 스크롤 (Infinite Scroll)
- [x] Pull-to-refresh 새로고침
- [x] 게시판 카테고리 시스템 (8개 카테고리)
- [x] 사용자 인증 시스템
- [x] Firebase Firestore 연동
- [x] **🔍 검색 기능 완전 구현** (community_search_screen.dart)
  - [x] 실시간 검색 (500ms debounce)
  - [x] 게시판별 필터링 (FilterChip)
  - [x] 검색어 하이라이팅 (연한 초록 배경)
  - [x] 제목/내용 검색, 최소 2글자
  - [x] 검색 결과 개수 표시
- [x] **🎨 브랜드 색상 통일** (베이지 → 갈색 그라데이션)
  - [x] 헤더, Drawer, FloatingActionButton
  - [x] 모든 로딩 프로그레스바 색상 통일
  - [x] 하단 탭바 및 전체 배경 흰색 통일
- [x] **👁️ 뷰 토글 기능** (카드뷰 ↔ 간단뷰)
  - [x] 헤더 토글 버튼 (view_list ↔ view_module)
  - [x] 2줄 간단뷰 레이아웃
  - [x] 구분선 및 간격 조정
- [x] **👤 프로필 이미지 문제 해결**
  - [x] photoURL/profileImageUrl fallback 로직
  - [x] 게시글 목록 및 Drawer 프로필 모두 적용
- [x] **📝 빈 상태 처리 개선**
  - [x] 로딩 상태와 빈 상태 분리
  - [x] "게시글이 없습니다" 메시지 표시

### ✅ Day 2 완성된 기능
- [x] **📖 게시글 상세보기** (community_detail_screen.dart) 
  - [x] 샘플과 동일한 UI 구조
  - [x] 작성자 정보 및 등급 표시
  - [x] 좋아요/공유/더보기 기능
  - [x] 댓글 시스템 기본 구조
  - [x] **HTML 형식 댓글 지원**
  - [x] **이미지 첨부 기능** (image_picker + Firebase Storage)

### ✅ **Day 3 완성된 기능 (2025.06.27)** 🎉
- [x] **🎨 커뮤니티 스크린 UI 개선**
  - [x] 카테고리 순서 변경 (자유게시판 2번째로 이동)
  - [x] 게시판 이름에 LinearGradient 적용 (ShaderMask 사용)
  - [x] HTML 미리보기 개선 (<br> 태그 기준 첫 번째 텍스트만 표시)
- [x] **📖 게시글 상세보기 완전 완성**
  - [x] 앱바 제목 제거 (중복 방지)
  - [x] **삼성멤버스 스타일 레이아웃** (boardId → title → time|viewCount → profile + stats → content)
  - [x] title 여백 조정 (더 컴팩트)
  - [x] **🔗 링크 클릭 기능** (url_launcher + 외부 브라우저 열기)
  - [x] HTML <br> 태그 간격 처리 (8px/6px)
  - [x] **줄바꿈 유지** (whiteSpace: WhiteSpace.pre)
- [x] **💬 댓글 시스템 완전 완성**
  - [x] 댓글 등급 표시 수정 (실제 displayGrade 사용)
  - [x] **정렬 기능** (등록순/최신순 동적 변경)
  - [x] 드롭다운 배경색 하얀색
  - [x] **멘션 스타일링** (@사용자명 파란색 강조)
  - [x] 답글 기능 (1depth 정책)
  - [x] 이미지 첨부 기능
  - [x] 좋아요 기능 (게시글/댓글)
  - [x] HTML 렌더링 완성
  - [x] 계층 구조 정렬 (부모 댓글 → 답글 순서)

### ✅ **Day 4 완성된 기능 (2025.06.28)** 🔔
- [x] **🔔 알림 시스템 완전 구현**
  - [x] **Firebase Cloud Functions** 알림 서비스
    - [x] 게시글 좋아요 알림 (`onPostLikeCreated`)
    - [x] 댓글 알림 (`onCommentCreated`)
    - [x] 대댓글 알림 (`onReplyCreated`)
    - [x] 댓글 좋아요 알림 (`onCommentLikeCreated`)
  - [x] **FCM 푸시 알림** 완전 구현
    - [x] 포그라운드/백그라운드/앱 종료 상태 처리
    - [x] 로컬 알림 생성 (포그라운드)
    - [x] 딥링크 데이터 포함 (postId, commentId, boardId, boardName)
  - [x] **딥링크 시스템** 완전 구현
    - [x] 게시글 상세 페이지로 자동 이동
    - [x] 특정 댓글로 스크롤 기능
    - [x] boardId → boardName 매핑
    - [x] 존재하지 않는 게시글/댓글 에러 처리
    - [x] **사용자 경험 최적화**
      - [x] 포그라운드에서 로컬 알림 생성 (바로 이동하지 않음)
      - [x] 일관된 알림 경험 (모든 상태에서 동일)
      - [x] 에러 시 홈화면으로 자동 이동
      - [x] 토스트 메시지로 명확한 피드백

### ✅ **Day 5-6 완성된 기능 (2025.06.29)** 👤
- [x] **👤 마이페이지 완전 구현**
  - [x] **MyPageScreen 생성** (`lib/screen/my_page_screen.dart`)
    - [x] 삼성멤버스 스타일 UI 디자인
    - [x] 프로필 이미지 (photoURL 기반, 편집 아이콘)
    - [x] 닉네임 (displayName, 굵은 글씨, 편집 기능)
    - [x] 이펙트 표시 (title 필드, 오렌지 배경)
    - [x] 좋아요 받은 수 (likesReceived)
    - [x] 팔로워/팔로잉 수 (followerCount/followingCount)
    - [x] 레벨 표시 (displayGrade)
    - [x] **3개 탭 활동 내역** (게시글/댓글/좋아요)
  - [x] **프로필 편집 기능 완전 구현**
    - [x] **프로필 이미지 편집** (갤러리 선택, Firebase Storage 업로드)
    - [x] **displayName 편집** (다이얼로그, 최대 20자)
    - [x] **기존 게시글/댓글 동기화** (프로필 변경 시 연관 데이터 업데이트)
    - [x] **독립적인 로딩 상태** (이미지/닉네임 편집 각각 독립)
  - [x] **활동 내역 탭 시스템**
    - [x] **TabController 구현** (3개 탭: 게시글/댓글/좋아요)
    - [x] **서브컬렉션 활용** (my_posts, my_comments, liked_posts)
    - [x] **실시간 카운트 표시** (탭별 실제 데이터 개수)
    - [x] **진입 시 모든 데이터 로딩** (병렬 로딩으로 성능 최적화)
  - [x] **커뮤니티 헤더 프로필 연동**
    - [x] 로그인 상태에서 헤더 오른쪽에 프로필 이미지 표시
    - [x] 프로필 이미지 클릭 시 MyPageScreen으로 이동
    - [x] photoURL 기반 동적 프로필 표시
  - [x] **데이터베이스 구조 최적화**
    - [x] **좋아요 시스템 개선** (likesCount 필드 추가)
    - [x] **게시글 작성 시 my_posts 업데이트** (배치 트랜잭션)
    - [x] **댓글 작성 시 my_comments 업데이트** (기존 완료)
    - [x] **좋아요 시 liked_posts 업데이트** (게시글 정보 저장)

### 🎯 **다음 작업 우선순위 (6가지 핵심 기능)**

#### 1. **🔒 프로필/닉네임 변경권 제한 시스템** ⭐⭐⭐⭐⭐ ✅ **완료**
- [x] **1회 무료 변경 시스템**
  - [x] 사용자별 변경 횟수 추적 (photoURLChangeCount, displayNameChangeCount)
  - [x] 첫 변경 후 편집 버튼 비활성화 (회색 처리)
  - [x] 변경 시도 시 "땅콩으로 구매" 팝업 표시
- [x] **땅콩 결제 시스템 연동**
  - [x] 변경권 구매 다이얼로그 (프로필 이미지: 50땅콩, 닉네임: 30땅콩)
  - [x] 땅콩 잔액 확인 및 차감
  - [x] 결제 완료 후 변경 가능 상태로 전환

#### 2. **🎨 마이페이지 탭바 UI 개선** ⭐⭐⭐⭐
- [x] **카드 형태 리스트 개선**
  - [x] 게시글 카드: 썸네일, 제목, 내용 미리보기, 좋아요/댓글 수
  - [x] 댓글 카드: 게시글 제목, 댓글 내용, 작성일
  - [x] 좋아요 카드: 게시글 썸네일, 제목, 좋아요한 날짜
- [x] **탭바 디자인 개선**
  - [x] 삼성멤버스 스타일 탭바 (둥근 모서리, 그림자)
  - [x] 선택된 탭 강조 효과
  - [x] 부드러운 애니메이션 전환

#### 3. **✨ 이펙트 효과 시스템** ⭐⭐⭐⭐
- [ ] **이펙트 관리 시스템**
  - [ ] 이펙트 컬렉션 설계 (effects 컬렉션)
  - [ ] 사용자별 보유 이펙트 (user_effects 서브컬렉션)
  - [ ] 이펙트 착용/해제 기능
- [ ] **이펙트 종류 구현**
  - [ ] 텍스트 이펙트 (색상, 그라데이션, 글로우)
  - [ ] 애니메이션 이펙트 (깜빡임, 흔들림)
  - [ ] 프레임 이펙트 (테두리, 배경)

#### 4. **👥 팔로워/팔로잉 시스템** ⭐⭐⭐⭐ ✅ **완료**
- [x] **팔로우 기능 구현**
  - [x] 사용자 프로필에서 팔로우/언팔로우 버튼
  - [x] followers/following 서브컬렉션 관리
  - [x] 팔로워/팔로잉 수 실시간 업데이트
- [x] **팔로우 목록 화면**
  - [x] 팔로워 목록 (프로필 이미지, 닉네임, 팔로우 상태)
  - [x] 팔로잉 목록 (언팔로우 버튼)
  - [x] 상대방 팔로워/팔로잉도 볼 수 있는 확장 기능

#### 5. **🔄 User Service 마이그레이션** ⭐⭐⭐⭐⭐
- [ ] **데이터베이스 구조 최종 확정**
  - [ ] users 컬렉션 필드 표준화
  - [ ] 기존 데이터 검증 및 정리
  - [ ] 누락된 필드 추가 (changeCount, effectId 등)
- [ ] **마이그레이션 스크립트 작성**
  - [ ] 기존 사용자 데이터 백업
  - [ ] 새 구조로 데이터 변환
  - [ ] 데이터 무결성 검증

#### 6. **🏆 레벨 상세 정보 페이지** ⭐⭐⭐ ✅ **완료**
- [x] **레벨 시스템 상세 화면**
  - [x] 현재 레벨 정보 (권한, 혜택)
  - [x] 다음 레벨까지 진행률
  - [x] 레벨별 요구사항 (활동 점수, 기간)
- [x] **레벨 업그레이드 신청**
  - [x] 업그레이드 조건 확인
  - [x] 자동 업그레이드 시스템
  - [x] 퍼스트 Lv.2 관리자 승인 대기 상태

---

## 🎯 **NEXT: 게시글 작성 기능 고도화** (최우선)

### ✍️ CommunityPostCreateScreen 개선
- **파일**: `lib/screen/community_post_create_screen.dart` (기존 파일 개선)
- **우선순위**: ⭐⭐⭐⭐⭐
- **예상 시간**: 4-6시간

**구현 사항:**
- [ ] 리치 텍스트 에디터 개선
- [ ] 이미지 업로드 UX 개선 (드래그 앤 드롭, 다중 선택)
- [ ] 미리보기 기능
- [ ] 임시저장 기능
- [ ] 게시글 수정 기능 개선
- [ ] 첨부파일 관리 개선

---

## 🤝 **완료된 댓글 시스템** ✅

### 💬 댓글 시스템 구조 (완성됨) - HTML 지원
**Database 구조:**
```json
comments/{commentId}: {
  "commentId": "cmt789",
  "uid": "user_abc",
  "displayName": "사용자명",
  "profileImageUrl": "프로필URL",
  "contentHtml": "<p>댓글 내용</p><img src='...' />",  // HTML 형식 지원
  "contentType": "html",          // 'text' 또는 'html' 구분
  "attachments": [                // 첨부파일 목록
    {
      "type": "image",
      "url": "https://storage.../posts/20241219/posts/postId123/comments/cmt789/images/cmt789_abc123.png",
      "filename": "screenshot.png"
    }
  ],
  "parentCommentId": null,        // 답글 관계 (null = 원댓글)
  "depth": 0,                     // 들여쓰기 레벨 (0 or 1만)
  "replyToUserId": null,          // 답글 대상 사용자
  "mentionedUsers": [],           // 멘션된 사용자들
  "hasMention": false,            // 멘션 포함 여부
  "createdAt": "timestamp",
  "updatedAt": "timestamp",
  "likesCount": 0,
  "isDeleted": false,
  "isHidden": false,
  "reportsCount": 0
}
```

**완성된 기능:**
- [x] 댓글 작성/수정/삭제
- [x] 답글 (대댓글) 기능 - 1depth 정책
- [x] 댓글 좋아요/싫어요
- [x] **멘션 기능** (@사용자명 파란색 스타일링)
- [x] 댓글 정렬 (등록순/최신순)
- [x] HTML 렌더링 및 이미지 첨부
- [x] 계층 구조 정렬

---

## 🔔 **완료된 알림 시스템** ✅

### 📱 알림 시스템 구조 (완성됨)
**Cloud Functions 구조:**
```javascript
// 게시글 좋아요 알림
exports.onPostLikeCreated = onDocumentCreated({
  document: "posts/{date}/posts/{postId}/likes/{uid}",
  // FCM 메시지 발송 + 딥링크 데이터 포함
});

// 댓글 알림
exports.onCommentCreated = onDocumentCreated({
  document: "posts/{date}/posts/{postId}/comments/{commentId}",
  // 게시글 작성자에게 댓글 알림
});

// 대댓글 알림
exports.onReplyCreated = onDocumentCreated({
  document: "posts/{date}/posts/{postId}/comments/{commentId}",
  // 부모 댓글 작성자에게 대댓글 알림
});

// 댓글 좋아요 알림
exports.onCommentLikeCreated = onDocumentCreated({
  document: "posts/{date}/posts/{postId}/comments/{commentId}/likes/{uid}",
  // 댓글 작성자에게 좋아요 알림
});
```

**딥링크 데이터 구조:**
```json
{
  "type": "post_like|post_comment|comment_reply|comment_like",
  "postId": "게시글ID",
  "commentId": "댓글ID (댓글 관련 알림만)",
  "boardId": "게시판ID",
  "boardName": "게시판이름",
  "date": "날짜",
  "path": "/community/detail/{date}/{postId}"
}
```

**완성된 기능:**
- [x] **4가지 알림 타입** 완전 구현
- [x] **FCM 푸시 알림** (포그라운드/백그라운드/앱종료)
- [x] **딥링크 시스템** (게시글/댓글 자동 이동)
- [x] **에러 처리** (존재하지 않는 게시글/댓글)
- [x] **사용자 경험 최적화** (일관된 알림 경험)
- [x] **boardId → boardName 매핑** (Cloud Functions)

---

## 🎯 1단계: 핵심 기능 완성 (거의 완료)

### ✅ 1.1 검색 및 UI 개선 완료 🔍
- **파일**: `lib/screen/community_screen.dart`
- **상태**: ✅ **완료**

### ✅ 1.2 게시글 상세보기 완료 📖
- **파일**: `lib/screen/community_detail_screen.dart`
- **상태**: ✅ **완료**

### 🔄 1.3 게시글 작성/수정 개선 ✍️
- **파일**: `lib/screen/community_post_create_screen.dart`
- **우선순위**: ⭐⭐⭐⭐
- **예상 시간**: 4-6시간
- **상태**: 🔄 **기본 기능 완료, 고도화 필요**

---

## 🤝 2단계: 상호작용 기능

### ✅ 2.1 댓글 시스템 완료 💬
- **우선순위**: ⭐⭐⭐⭐
- **상태**: ✅ **완료**

### ✅ 2.2 좋아요/싫어요 시스템 완료 👍👎
- **우선순위**: ⭐⭐⭐
- **상태**: ✅ **완료**

### ✅ 2.3 알림 시스템 완료 🔔
- **우선순위**: ⭐⭐⭐
- **상태**: ✅ **완료**

**구현 완료 사항:**
- [x] 댓글 알림
- [x] 좋아요 알림
- [x] 답글 알림
- [x] 댓글 좋아요 알림
- [x] 푸시 알림 (FCM)
- [x] 딥링크 시스템
- [x] 에러 처리

---

## ✨ 3단계: 사용자 경험 향상

### 3.1 미디어 처리 📸
- **우선순위**: ⭐⭐⭐
- **예상 시간**: 3-4시간

**구현 사항:**
- [x] 이미지 업로드/압축 (기본 완료)
- [ ] 동영상 업로드
- [ ] 파일 첨부
- [ ] 이미지 갤러리 뷰어
- [ ] 이미지 캐싱

### 3.2 마이페이지 활동 내역 완성 👤
- **우선순위**: ⭐⭐⭐⭐
- **예상 시간**: 4-6시간
- **상태**: ✅ **완료**

**완성된 사항:**
- [x] 기본 마이페이지 UI (삼성멤버스 스타일)
- [x] 프로필 정보 표시 (이미지, 닉네임, 좋아요 수, 팔로워/팔로잉)
- [x] 레벨 및 뱃지 영역
- [x] 커뮤니티 헤더에서 프로필 이미지 연동
- [x] **활동 내역 탭**
  - [x] 작성한 게시글 목록
  - [x] 댓글 히스토리
  - [x] 좋아요한 게시글
- [x] **프로필 편집 기능**
  - [x] 닉네임 수정
  - [x] 프로필 사진 수정/업로드
  - [x] 자기소개 편집
- [x] **게시글 상세 화면 네비게이션**
  - [x] 작성한 게시글 → 게시글 상세 화면
  - [x] 댓글 → 게시글 상세 화면 (댓글 위치로 스크롤)
  - [x] 좋아요한 게시글 → 게시글 상세 화면
- [x] **변경권 제한 시스템**
  - [x] 프로필 이미지 1회 무료 변경 후 땅콩 결제
  - [x] 닉네임 1회 무료 변경 후 땅콩 결제
  - [x] 변경권 구매 다이얼로그
  - [x] 땅콩 소모 확인 다이얼로그

### ✅ **Day 7 완성된 기능 (2025.07.01)** 🔐🎨👥
- [x] **🔒 프로필/닉네임 변경권 제한 시스템 완전 구현**
  - [x] **1회 무료 변경 시스템**
    - [x] 사용자별 변경 횟수 추적 (photoURLChangeCount, displayNameChangeCount)
    - [x] 첫 변경 후 편집 버튼 비활성화 (회색 처리)
    - [x] 변경 시도 시 "땅콩으로 구매" 팝업 표시
    - [x] 변경 횟수 UI 표시 (프로필/닉네임 변경 (1회))
  - [x] **땅콩 결제 시스템 연동**
    - [x] 변경권 구매 다이얼로그 (프로필 이미지: 50땅콩, 닉네임: 30땅콩)
    - [x] 땅콩 잔액 확인 및 차감 (UserService.changeDisplayName)
    - [x] 결제 완료 후 변경 가능 상태로 전환
    - [x] 땅콩 부족 시 구매 안내 메시지
  - [x] **UX 개선**
    - [x] 닉네임 변경 시 띄어쓰기/특수문자 정책 안내
    - [x] 프로필 이미지 변경 시 정책 안내 문구
    - [x] 변경권 소모 시 명확한 피드백
    - [x] 마이그레이션 함수로 기존 사용자 데이터 업데이트

- [x] **🎨 마이페이지 UI 대폭 개선**
  - [x] **활동 내역 카드형 디자인**
    - [x] 게시글 카드: 게시판명, 제목, 날짜
    - [x] 댓글 카드: 댓글 내용(@멘션 파란색), 날짜
    - [x] 좋아요 카드: 게시글 제목, 좋아요한 날짜
  - [x] **탭바 디자인 완전 개선**
    - [x] 삼성멤버스 스타일 탭바 (흰색 배경, 갈색 인디케이터)
    - [x] NestedScrollView로 부드러운 스크롤
    - [x] 하단 여백 추가 (32px)
  - [x] **프로필 정보 UI 개선**
    - [x] 땅콩 아이콘 및 개수 표시
    - [x] 변경 횟수 정보 표시
    - [x] 실시간 업데이트 (didChangeDependencies)

- [x] **👥 팔로워/팔로잉 시스템 완전 구현**
  - [x] **팔로우 기능 구현**
    - [x] followers/following 서브컬렉션 + followerCount/followingCount 필드 동시 업데이트
    - [x] 배치 트랜잭션으로 데이터 일관성 보장
    - [x] 실시간 팔로워/팔로잉 수 업데이트
  - [x] **팔로워/팔로잉 리스트 화면**
    - [x] FollowerListScreen: 팔로워 목록, 팔로우/팔로잉 버튼
    - [x] FollowingListScreen: 팔로잉 목록, 팔로우 취소 팝업
    - [x] 삼성멤버스 스타일 UI (프로필 이미지, 닉네임, 레벨)
    - [x] 팔로우 취소 팝업 디자인 개선 (하얀 배경, 검정 글씨, 큰 폰트)
  - [x] **UserProfileScreen 구현**
    - [x] 상대방 프로필 화면 (user_profile_screen.dart)
    - [x] 프로필 이미지, 닉네임, 레벨, 팔로워/팔로잉 수
    - [x] 팔로우/팔로잉 버튼 토글
    - [x] 게시글/댓글 탭 (my_page_screen과 유사 구조)
    - [x] 팔로워/팔로잉 클릭 시 해당 리스트로 이동 (내가 팔로우 가능)
  - [x] **프로필 진입 연결**
    - [x] community_detail_screen에서 author/댓글 프로필 클릭
    - [x] 본인 uid면 MyPageScreen, 다른 uid면 UserProfileScreen 분기
    - [x] 게시글/댓글 클릭 시 해당 포스트로 정확한 이동 (postPath/commentPath 파싱)

### ✅ **Day 8 완성된 기능 (2025.07.02)** 🏆
- [x] **🏆 레벨 상세 정보 페이지 완전 구현**
  - [x] **삼성멤버스 + 당근마켓 스타일 UI**
    - [x] 현재 레벨 카드 (다이아몬드 아이콘, 그라데이션 배경)
    - [x] 다음 레벨까지 진행률 표시
    - [x] 당근마켓 스타일 미션 카드 (완료/미완료 상태)
    - [x] 프로그레스 바 애니메이션 (1.5초 부드러운 전환)
  - [x] **레벨 정책 시스템 구현**
    - [x] **이코노미 Lv.1-5** (게시글, 댓글, 좋아요 기준)
      - Lv.1: 기본 가입 (게시글 0개, 댓글 0개, 좋아요 0회)
      - Lv.2: 게시글 2개, 댓글 5개, 좋아요 10회
      - Lv.3: 게시글 5개, 댓글 15개, 좋아요 20회
      - Lv.4: 게시글 10개, 댓글 30개, 좋아요 50회
      - Lv.5: 게시글 20개, 댓글 50개, 좋아요 100회
    - [x] **비즈니스 Lv.1-5** (높은 활동 요구사항)
      - Lv.1: 게시글 30개, 댓글 70개, 좋아요 150회
      - Lv.2: 게시글 50개, 댓글 120개, 좋아요 300회
      - Lv.3: 게시글 80개, 댓글 200개, 좋아요 500회
      - Lv.4: 게시글 120개, 댓글 300개, 좋아요 800회
      - Lv.5: 게시글 200개, 댓글 500개, 좋아요 1500회
    - [x] **퍼스트 Lv.1-2** (땅콩, 팔로워 추가 요구사항)
      - Lv.1: 게시글 150개, 댓글 400개, 좋아요 1500회, 땅콩 500개, 팔로워 30명
      - Lv.2: 운영자 승인 필요 (신고 누적 0, 건전한 커뮤니티 활동)
    - [x] **등급별 색상 차별화** 
      - 이코노미: Colors.grey[100~500] (레벨별 강도)
      - 비즈니스: Colors.blue[100~500] (레벨별 강도)  
      - 퍼스트: Colors.red[100~500] (레벨별 강도)
  - [x] **자동 업그레이드 시스템**
    - [x] 실시간 활동 통계 조회 (my_posts, my_comments, liked_posts)
    - [x] 조건 달성 시 업그레이드 버튼 활성화
    - [x] 레벨업 축하 다이얼로그 (깔끔한 디자인)
    - [x] 퍼스트 Lv.2는 운영자 승인 필요 시스템
  - [x] **마이페이지 연동**
    - [x] 레벨 섹션 클릭 시 상세 페이지 이동
    - [x] 레벨업 후 마이페이지 프로필 자동 새로고침
    - [x] 업그레이드 버튼 그라데이션 디자인 (🚀 이모티콘)
  - [x] **UI/UX 완성도 향상**
    - [x] 좌석 아이콘 (airline_seat_recline_extra) 적용
    - [x] 등급별 + 레벨별 동적 색상 시스템
    - [x] 프로그레스바 둥근 모서리 처리 (ClipRRect)
    - [x] 레벨업 다이얼로그 동적 색상 적용
    - [x] 전체 진행도 프로그레스바 (삼성멤버스 스타일)
    - [x] 당근마켓 스타일 미션 카드 UI

### 🎯 **다음 작업 우선순위 (2가지 핵심 기능)**

#### 1. **✨ 이펙트 효과 시스템** ⭐⭐⭐⭐ ✅ **완료**
- [x] **이펙트 관리 시스템**
  - [x] 이펙트 컬렉션 설계 (effects 컬렉션)
  - [x] 사용자별 보유 이펙트 (user_effects 서브컬렉션)
  - [x] 이펙트 착용/해제 기능
- [x] **이펙트 종류 구현**
  - [x] 텍스트 이펙트 (색상, 그라데이션, 글로우)
  - [x] 애니메이션 이펙트 (깜빡임, 흔들림)
  - [x] 프레임 이펙트 (테두리, 배경)
- [x] **게시글/댓글 currentSkyEffect 완전 동기화**
  - [x] 게시글/댓글 생성 시 currentSkyEffect 필드 항상 저장
  - [x] 스카이이펙트 변경 시 기존 게시글/댓글 일괄 업데이트
  - [x] 모든 화면에서 이펙트 정상 표시

#### 2. **🔄 User Service 마이그레이션** ⭐⭐⭐⭐⭐
- [ ] **데이터베이스 구조 최종 확정**
  - [ ] users 컬렉션 필드 표준화
  - [ ] 기존 데이터 검증 및 정리
  - [ ] 누락된 필드 추가 (changeCount, effectId 등)
- [ ] **마이그레이션 스크립트 작성**
  - [ ] 기존 사용자 데이터 백업
  - [ ] 새 구조로 데이터 변환
  - [ ] 데이터 무결성 검증

---

## 🏆 4단계: 등급 시스템 및 정책

### 4.1 등급 시스템 구현 🎖️
- **우선순위**: ⭐⭐⭐
- **예상 시간**: 5-6시간

**구현 사항:**
- [ ] **등급별 정책 설계**
  - [ ] 이코노미 Lv.1-5
  - [ ] 비즈니스 Lv.1-5  
  - [ ] 퍼스트 Lv.1-5
  - [ ] 등급별 권한 차등화
- [ ] **수동 등급 업그레이드 시스템**
  - [ ] 마이페이지 업그레이드 버튼
  - [ ] 등급 신청/승인 프로세스
  - [ ] 관리자 승인 시스템

---

## 🛡️ 5단계: 관리 및 보안

### 5.1 신고 시스템 🚨
- **우선순위**: ⭐⭐⭐
- **예상 시간**: 4-5시간

**구현 사항:**
- [ ] 게시글/댓글 신고
- [ ] 신고 사유 선택
- [ ] 관리자 신고 검토
- [ ] 자동 숨김 처리

### 5.2 관리자 기능 🔧
- **우선순위**: ⭐⭐
- **예상 시간**: 6-8시간

**구현 사항:**
- [ ] 관리자 대시보드
- [ ] 게시글/댓글 관리
- [ ] 사용자 관리
- [ ] 신고 처리
- [ ] 공지사항 관리

---

## 📅 **수정된 개발 스케줄** (4주 계획)

### ✅ Week 1 완료 (Day 1: ~80%)
- [x] 검색 기능 완전 구현
- [x] 브랜드 색상 통일
- [x] 뷰 토글 기능
- [x] 프로필 이미지 수정
- [x] 빈 상태 처리

### ✅ Week 2 완료: 게시글 상세 및 댓글 (2024.12.25 완성)
- **Day 2**: ✅ 게시글 상세보기 구현 완료 + HTML 댓글 + 이미지 첨부
- **Day 3**: ✅ 삼성멤버스 스타일 레이아웃 + 댓글 시스템 완전 완성 + 멘션 기능
- **Day 4-5**: ✅ 좋아요 시스템 + 정렬 기능 + HTML 렌더링 완성
- **Day 6-7**: ✅ 링크 클릭 + UI 개선 + 답글 시스템

### ✅ Week 3: 알림 시스템 및 마이페이지 (2025.06.27-29 완성)
- **Day 1-2**: ✅ 알림 시스템 완전 구현 (FCM + 딥링크)
- **Day 3-4**: ✅ 댓글 시스템 고도화 (멘션, 정렬, HTML)
- **Day 5-6**: ✅ 마이페이지 완전 구현 (프로필 편집, 활동 내역 탭, 데이터 동기화)

### 🎯 Week 4: 고급 기능 및 시스템 완성 (2025.06.30-07.06)
- **Day 1-2**: 프로필/닉네임 변경권 제한 시스템 + 땅콩 결제 연동
- **Day 3**: 마이페이지 탭바 UI 개선 + 카드 형태 리스트
- **Day 4**: 이펙트 효과 시스템 구현
- **Day 5**: 팔로워/팔로잉 시스템 + 좋아요 기능 확장
- **Day 6**: User Service 마이그레이션 + 레벨 상세 페이지
- **Day 7**: 전체 테스트 및 최종 점검

---

## 🔧 기술적 고려사항

### ✅ 완료된 패키지 설치
```yaml
dependencies:
  share_plus: ^7.0.0     # 공유 기능 ✅
  url_launcher: ^6.0.0   # 링크 열기 ✅
  flutter_html: ^3.0.0   # HTML 렌더링 ✅
  image_picker: ^1.0.0   # 이미지 선택 ✅
  firebase_storage: ^11.0.0  # 이미지 업로드 ✅
```

### 다음 필요 패키지
```yaml
dependencies:
  firebase_messaging: ^14.0.0   # 푸시 알림
  flutter_local_notifications: ^16.0.0  # 로컬 알림
```

---

## 🚀 **즉시 시작할 작업**

**NEXT STEP:**
1. [ ] **게시글 작성 기능 고도화** (리치 텍스트 에디터 개선)
2. [ ] **알림 시스템 구현** (댓글/좋아요 알림)
3. [ ] **마이페이지 기본 구조** 생성
4. [ ] **등급 시스템 설계** 문서화

**완성 목표:** Week 3 완료 (2024.12.31까지) - 게시글 작성 고도화 + 알림 + 마이페이지

---

## 🎉 **현재 성과**

### 📊 **전체 진행률: ~98%** 
- **핵심 기능**: ✅ 완료 (게시글 목록, 상세보기, 댓글 시스템, 알림 시스템, 마이페이지)
- **사용자 경험**: ✅ 완료 (프로필 편집, 활동 내역, 데이터 동기화, 팔로우 시스템)
- [x] **레벨 시스템**: ✅ 완료 (레벨 상세 페이지, 자동 업그레이드, 활동 통계)
- **고급 기능**: 🔄 마무리 단계 (이펙트 시스템, DB 마이그레이션)

### 🏆 **주요 완성 기능**
1. **완전한 댓글 시스템** (답글, 멘션, 좋아요, 정렬)
2. **삼성멤버스급 UI/UX** (깔끔한 레이아웃)
3. **HTML 지원** (링크, 이미지, 서식)
4. **실시간 검색** (고급 필터링)
5. **푸시 알림 시스템** (FCM + 딥링크)
6. **완전한 마이페이지** (프로필 편집, 활동 내역 탭, 데이터 동기화)
7. **프로필 관리 시스템** (이미지/닉네임 편집, 변경권 제한, 땅콩 결제)
8. **팔로우 시스템** (팔로워/팔로잉 관리, 상대방 프로필 조회)
9. **레벨 시스템** (상세 페이지, 자동 업그레이드, 당근마켓 스타일 미션)

### 🎯 **최종 마무리: 2가지 핵심 기능**
1. **✨ 이펙트 시스템** (텍스트, 애니메이션, 프레임)
2. **🔄 DB 마이그레이션** (구조 표준화, 데이터 검증)

---

*마지막 업데이트: 2025-07-02 Day 8 레벨 상세 정보 페이지 완전 완성*
*작성자: AI Assistant*

## 🆕 2025.07.03~07.04 주요 개선 내역

- [x] **게시글/댓글 currentSkyEffect(스카이이펙트) 완전 동기화** ✅
  - [x] 게시글/댓글 생성 시 currentSkyEffect 필드 항상 저장
  - [x] 스카이이펙트 변경 시 기존 게시글/댓글 일괄 업데이트
  - [x] 게시글/댓글/마이페이지/프로필 등 모든 곳에 이펙트 정상 표시

- [x] **신고 기능 고도화** ✅
  - [x] 신고 데이터 구조 개선: reports/posts, reports/comments로 분리 저장
  - [x] 신고 데이터에 detailPath(딥링크용 경로) 추가
  - [x] 이미 신고한 댓글은 ... (더보기/신고) 버튼 비노출 (중복 신고 방지)
  - [x] 신고 직후 ... 버튼 즉시 사라지도록 반영
  - [x] 신고 다이얼로그 UI 개선 (버튼/라디오/테두리 검정색)

- [x] **커뮤니티/마이페이지/프로필 UX 개선**
  - [x] 게시글/댓글 카드 displayName 옆 "최신" 뱃지, 우측 상단 시간 표시 (삼성멤버스 스타일)
  - [x] 댓글 수정/삭제 팝업 radius 적용 (더 둥글게)
  - [x] 댓글 수정 기능 완전 구현 (입력창에 기존 내용, 수정 완료 시 업데이트)
  - [x] 댓글 삭제 시 posts, users/my_comments 모두 삭제 및 commentCount 감소
  - [x] 마이페이지/유저프로필 탭 스크롤 NestedScrollView 연동 (상단 프로필/탭바 자연스럽게 노출)
  - [x] 기타 UI/UX 미세조정 (색상, 간격, 포커스 등) 